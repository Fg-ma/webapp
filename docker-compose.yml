version: '3'

services:
    frontend:
        build:
            context: ./client
            dockerfile: Dockerfile
        ports:
            - "${FRONTEND_PORT}:3000"
        depends_on:
            - backend

    backend:
        build:
            context: ./server
            dockerfile: Dockerfile
        ports:
            - "${SERVER_PORT:-5041}:${SERVER_PORT:-5041}"
            - "${API_PORT:-5042}:${API_PORT:-5042}"
        environment:
            - NODE_ENV=production
            - PORT=${SERVER_PORT:-5041}
        depends_on:
            - db

    db:
        image: mysql:latest
        environment:
            MYSQL_ROOT_PASSWORD: "${DB_PASSWORD}"
            MYSQL_DATABASE: "${DB_DATABASE}"
            MYSQL_USER: "${DB_USER}"
            MYSQL_PASSWORD: "${DB_PASSWORD}"
            MYSQL_PORT: "${DB_PORT}"